@using Newtonsoft.Json
@using Newtonsoft.Json.Converters
@using SalesWebApplication.Models
@*@model IEnumerable <SalesViewModel>*@

@{
    ViewBag.Title = "Home Page";
}

<div id="SalesWrapper">
    <div class="jumbotron">
        
            @*<div class="classic-buttons">
                <a href="#" data-bind="click: showAddSalesForm, css:{'light-button': AddSalesModel.IsActive(), 'dark-button': !AddSalesModel.IsActive()}">Добавить запись в БД</a>
            </div>

            <div data-bind="with: AddSalesModel">
                <div data-bind="visible: IsActive()">
                    <h2>Добавление записи</h2>
                    <div data-bind="visible: IsActive()">
                        <div class="form form-validate ">
                            <div class="form-group">
                                <input type="text" data-bind="value: ManagerName" class="form-control" placeholder="Менеджер" />
                            </div>
                            <div class="form-group">
                                <input type="text" data-bind="value: CustomerName" class="form-control" placeholder="Клиент" />
                            </div>
                            <div class="form-group">
                                <input type="text" data-bind="value: ProductName" class="form-control" placeholder="Товар" />
                            </div>
                            <div class="form-group">
                                <input type="text" data-bind="value: Amount" class="form-control" placeholder="Сумма" />
                            </div>
                            <div class="classic-buttons">
                                <button class="btn btn-primary" data-bind="click: ok">Добавить</button>
                                <button class="btn btn-close" data-bind="click: cancel">Отмена</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>*@


            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Дата</th>
                        <th>Менеджер</th>
                        <th>Клиент</th>
                        <th>Товар</th>
                        <th>Сумма</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: Sales">
                    <tr>
                        @*<td data-bind="date: Date, dateFormat: 'DD-MM-YYYY hh:mm:ss'"></td>*@
                        <td data-bind="text: Date"></td>
                        <td data-bind="text: ManagerName"></td>
                        <td data-bind="text: CustomerName"></td>
                        <td data-bind="text: ProductName"></td>
                        <td data-bind="text: Amount"></td>
                        <td><button class="btn btn-primary" data-bind="click: $root.deleteSales">Удалить</button></td>
                        
                    </tr>
                </tbody>
            </table>
        </div>

    <div class="row">
        <div id="chart_div"></div>
    </div>

</div>

    @Scripts.Render("~/bundles/knockout")
   <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
    $(function ()
    {
        var myViewModel = new SalesViewModel();
        ko.applyBindings(myViewModel, $("#SalesWrapper")[0]);
    });


    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart()
    {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'ProductName');
        data.addColumn('number', 'Amout');

        data.addRows([
            ['Mushrooms', 3],
            ['Onions', 1],
            ['Olives', 1],
            ['Zucchini', 1],
            ['Pepperoni', 2]
        ]);

        var options = {'title':'Диаграмма проданных товаров',
            'width':600,
            'height': 400
        };

        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, options);
    }
</script>
