@using Newtonsoft.Json
@using Newtonsoft.Json.Converters
@using SalesWebApplication.Models
@*@model IEnumerable <SalesViewModel>*@

@{
    ViewBag.Title = "Home Page";
}

<div id="SalesWrapper">
    <div class="jumbotron">
        <div id="myModal" class="modal fade">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                        <h4 id="NameForm" class="modal-title">Добавление записи</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-validate">
                            <div class="form-group">
                                <input type="hidden" data-bind="value: Id" id="Id" class="form-control" />
                            </div>
                            <div class="form-group">
                                <input type="datetime-local" data-bind="value: DateTime" id="DateTime" class="form-control" />
                            </div>
                            <div class="form-group">
                                <input type="text" data-bind="value: ManagerName" id="ManagerName" class="form-control" placeholder="Менеджер" />
                            </div>
                            <div class="form-group">
                                <input type="text" data-bind="value: CustomerName" id="CustomerName" class="form-control" placeholder="Клиент" />
                            </div>
                            <div class="form-group">
                                <input type="text" data-bind="value: ProductName" id="ProductName" class="form-control" placeholder="Товар" />
                            </div>
                            <div class="form-group">
                                <input type="text" data-bind="value: Amount" id="Amount" class="form-control" placeholder="Сумма" />
                            </div>
                            <div class="classic-buttons">
                                <button class="btn btn-primary" data-bind="click: save">Добавить</button>
                                <button class="btn btn-close" data-dismiss="modal" data-bind="click: clearForm">Отмена</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <td><a href="#myModal" class="btn btn-primary" data-bind="click: $root.loadSalesForm" data-toggle="modal">Добавить запись</a></td>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th></th>
                    <th></th>
                    <th>Дата</th>
                    <th>Менеджер</th>
                    <th>Клиент</th>
                    <th>Товар</th>
                    <th>Сумма</th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody data-bind="foreach: Sales">
                <tr>
                    <th data-index="$index"></th>
                    <td data-bind="text: Id"></td>
                    <td data-bind="text: DateTime"></td>
                    <td data-bind="text: ManagerName"></td>
                    <td data-bind="text: CustomerName"></td>
                    <td data-bind="text: ProductName"></td>
                    <td data-bind="text: Amount"></td>
                    <td><a href="#myModal" class="btn btn-primary" data-bind="click: $root.loadSalesEditForm" data-toggle="modal">Редактировать</a></td>
                    <td><button class="btn btn-primary" data-bind="click: $root.deleteSales">Удалить</button></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

@Scripts.Render("~/bundles/knockout")
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script>
    $(function () {
        var myViewModel = new SalesViewModel();
        ko.applyBindings(myViewModel, $("#SalesWrapper")[0]);
    });
</script>
